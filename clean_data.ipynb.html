<html>
<head>
<title>clean_data.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #8c8c8c; font-style: italic;}
.s1 { color: #0033b3;}
.s2 { color: #080808;}
.s3 { color: #067d17;}
.s4 { color: #1750eb;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
clean_data.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">#%% 
</span><span class="s1">import </span><span class="s2">pandas </span><span class="s1">as </span><span class="s2">pd</span>
<span class="s1">import </span><span class="s2">numpy </span><span class="s1">as </span><span class="s2">np</span>
<span class="s0">#%% 
</span><span class="s2">df = pd.read_csv(</span><span class="s3">&quot;F:/Onedrive/documents/GitHub/DSDV_project/data/Life Expectancy Data.csv&quot;</span><span class="s2">)</span>
<span class="s2">df.head()</span>
<span class="s0">#%% 
</span><span class="s2">print(df.columns.tolist())</span>
<span class="s0">#%% 
</span><span class="s2">df1 = pd.DataFrame(df)</span>
<span class="s2">print(df1)</span>
<span class="s0">#%% 
</span><span class="s2">col_to_drop = [</span><span class="s3">' thinness  1-19 years'</span><span class="s2">,</span><span class="s3">' thinness 5-9 years'</span><span class="s2">, </span><span class="s3">'Schooling'</span><span class="s2">]</span>
<span class="s2">data = df1.drop(col_to_drop,axis=</span><span class="s4">1</span><span class="s2">)</span>
<span class="s0">#%% 
</span><span class="s2">data_fill = data.fillna(</span><span class="s4">0</span><span class="s2">)</span>
<span class="s2">print(data_fill)</span>
<span class="s0">#%% 
</span><span class="s2">grouped = data_fill.groupby(</span><span class="s3">'Year'</span><span class="s2">)</span>
<span class="s2">dfs_by_year = []</span>
<span class="s1">for </span><span class="s2">year, data_year </span><span class="s1">in </span><span class="s2">grouped:</span>
    <span class="s2">dfs_by_year.append(data_year)</span>
<span class="s1">try</span><span class="s2">:</span>
    <span class="s2">all_data = pd.concat(dfs_by_year)</span>
    <span class="s2">all_data.to_csv(</span><span class="s3">&quot;all_years_data.csv&quot;</span><span class="s2">, index=</span><span class="s1">False</span><span class="s2">)</span>
    <span class="s2">print(all_data)</span>
<span class="s1">except </span><span class="s2">KeyError </span><span class="s1">as </span><span class="s2">e:</span>
    <span class="s2">print(</span><span class="s3">f&quot;Error: </span><span class="s5">{</span><span class="s2">e</span><span class="s5">}</span><span class="s3">&quot;</span><span class="s2">)</span>
<span class="s2">all_data = pd.concat(dfs_by_year)</span>
<span class="s2">all_data.to_csv(</span><span class="s3">&quot;all_years_data.csv&quot;</span><span class="s2">,index=</span><span class="s1">False</span><span class="s2">)</span>
<span class="s2">print(all_data)</span>
    
<span class="s0">#%% 
</span><span class="s2">all_years = pd.read_csv(</span><span class="s3">&quot;C:/Users/Hii/Downloads/ChineseChess-AlphaZero-distributed/ChineseChess-AlphaZero-distributed/cchess_alphazero/environment/all_years_data.csv&quot;</span><span class="s2">)</span>
<span class="s2">grouped_by_year = all_years.groupby(</span><span class="s3">'Year'</span><span class="s2">)</span>

<span class="s0">#%% 
</span><span class="s1">with </span><span class="s2">pd.ExcelWriter(</span><span class="s3">'data_by_year.xlsx'</span><span class="s2">, engine = </span><span class="s3">'xlsxwriter'</span><span class="s2">) </span><span class="s1">as </span><span class="s2">writer:</span>
    <span class="s1">for </span><span class="s2">year, data_year </span><span class="s1">in </span><span class="s2">grouped_by_year:</span>
        <span class="s2">data_year_without_year = data_year.drop(columns=[</span><span class="s3">'Year'</span><span class="s2">])</span>
        <span class="s2">data_year_without_year.to_excel(writer,sheet_name=str(year),index=</span><span class="s1">False</span><span class="s2">)</span>
<span class="s0">#%% 
</span><span class="s2">grouped1 = data_fill.groupby(</span><span class="s3">'Year'</span><span class="s2">)</span>
<span class="s1">for </span><span class="s2">year, data_year </span><span class="s1">in </span><span class="s2">grouped1:</span>
    <span class="s2">filename = </span><span class="s3">f&quot;C:/Users/Hii/Downloads/data_</span><span class="s5">{</span><span class="s2">year</span><span class="s5">}</span><span class="s3">.csv&quot;</span>
    <span class="s2">data_year.to_csv(filename, index=</span><span class="s1">False</span><span class="s2">)</span>
    <span class="s2">print(</span><span class="s3">f&quot;Data for year </span><span class="s5">{</span><span class="s2">year</span><span class="s5">} </span><span class="s3">saved to </span><span class="s5">{</span><span class="s2">filename</span><span class="s5">}</span><span class="s3">&quot;</span><span class="s2">)</span>
<span class="s0">#%% 
</span></pre>
</body>
</html>